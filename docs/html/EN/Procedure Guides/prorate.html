
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Prorating &#8212; Banff 3.01.002 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=2a807888" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=d4abd058"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'EN/Procedure Guides/prorate';</script>
    <link rel="index" title="Index" href="../../genindex" />
    <link rel="search" title="Search" href="../../search" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/banff_white.png" class="logo__image only-light" alt="Banff 3.01.002 documentation - Home"/>
    <img src="../../_static/banff_white.png" class="logo__image only-dark pst-js-only" alt="Banff 3.01.002 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index">
    English
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../FR/index">
    Français
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/StatCan/gensol-banff" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index">
    English
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../FR/index">
    Français
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/StatCan/gensol-banff" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Prorating</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="prorating">
<h1>Prorating<a class="headerlink" href="#prorating" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Execution: <em>banff.prorate()</em></p></li>
<li><p>SDE function types: <em>Review, Selection, Treatment</em></p></li>
<li><p>Input status flags: <em>I– (optional)</em></p></li>
<li><p>Output status flags: <em>IPR</em></p></li>
</ul>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading">#</a></h2>
<p>Prorates and rounds records to satisfy user-specified edits.</p>
<p>Unlike other Banff procedures, the <code class="docutils literal notranslate"><span class="pre">edits</span></code> for this procedure follow specific criteria: only equalities are permitted, and the set of edits must form a hierarchical structure that sums to a grand-total. For example:</p>
<p>$$
subtotal1 + subtotal2 = grandtotal \
a + b + c = subtotal1 \
d + e + f = subtotal2
$$</p>
<p>Each individual edit must consist of a set of components <em>x<sub>i</sub></em> that sum to a total <em>y</em>, i.e., of the form <em>x<sub>1</sub> + … x<sub>n</sub> = y</em>. Inequalities and constants are not permitted. For each individual edit equation that is not satisfied, one of the two prorating algorithms (<code class="docutils literal notranslate"><span class="pre">basic</span></code> or <code class="docutils literal notranslate"><span class="pre">scaling</span></code>) is applied in order to rake the components to match the total. The procedure takes a top-down approach, beginning with the grand-total (which is never changed) and adjusting components as necessary, until the full set of edits is satisfied. Missing values are not prorated; they are set to zero during the procedure and reset to missing afterwards. Values of zero are never altered.</p>
<p>Additional features:</p>
<ul class="simple">
<li><p>Automatic rounding to the desired number of decimal places.</p></li>
<li><p>Optional bounds to constrain the relative change of values during prorating.</p></li>
<li><p>Control over which variables are eligible for prorating.</p></li>
<li><p>Option to limit prorating to original or previously imputed values, either globally or for individual variables.</p></li>
<li><p>Weights to adjust the relative change of individual variables.</p></li>
</ul>
<p>For a full mathematical description of the procedure methods, with examples, please see the <a class="reference download internal" download="" href="../../_downloads/af41e91dc19117dffc1756544e8fed50/Banff%20Functional%20Description.pdf"><span class="xref download myst">Functional Description</span></a>.</p>
</section>
<section id="input-and-output-tables">
<h2>Input and output tables<a class="headerlink" href="#input-and-output-tables" title="Link to this heading">#</a></h2>
<p>Descriptions of input and output tables are given below. Banff supports a number of input and output formats; please see the Banff User Guide for more information.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Input table</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>indata</p></td>
<td><p>Input statistical data. Mandatory.</p></td>
</tr>
<tr class="row-odd"><td><p>instatus</p></td>
<td><p>Input status file containing I– status flags.<br><br> The instatus file is only required if at least one modifier is “ORIGINAL” or “IMPUTED”. In this case, the procedure will search through imputation flags of the form I– to determine which values were previously imputed. For the purpose of prorating, values with a status of FTI or IDE are considered original values.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Output table</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>outdata</p></td>
<td><p>Output statistical table containing imputed data. <br><br> Note that outdata will only contain successfully imputed records and affected fields. Users should update indata with the values from outdata before continuing the data editing process.</p></td>
</tr>
<tr class="row-odd"><td><p>outstatus</p></td>
<td><p>Output status file identifying imputed fields with IPR status flags, and their values after imputation.</p></td>
</tr>
<tr class="row-even"><td><p>outreject</p></td>
<td><p>Output table containing records that failed prorating. <br><br> For an individual record, there are potentially many reasons prorating could not be performed; please see the notes below for more details.</p></td>
</tr>
</tbody>
</table>
</div>
<p>For details on the content of output tables, please see the <a class="reference internal" href="../output_tables"><span class="std std-doc">Output Tables</span></a> document.</p>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Python type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>unit_id</p></td>
<td><p>str</p></td>
<td><p>Identify key variable (unit identifier) on indata. Mandatory. <br><br> Must be unique for each record. Records with a missing value are dropped before processing.</p></td>
</tr>
<tr class="row-odd"><td><p>edits</p></td>
<td><p>str</p></td>
<td><p>List of edits that the prorating procedure must satisfy. Mandatory. <br><br> Please see the <a class="reference internal" href="../user_guide#specifying-linear-edits"><span class="std std-ref">user guide</span></a> for general info on specifying edits. Unlike the other edit-based procedures in Banff, the prorate procedure places certain restrictions on the edit list; please see the notes below for details.</p></td>
</tr>
<tr class="row-even"><td><p>decimal</p></td>
<td><p>int</p></td>
<td><p>Number of decimals used in the rounding algorithm (between 0 and 9). Default=0. <br><br> The number of decimals specified must be equal to or greater than the actual number of decimals found on the total.</p></td>
</tr>
<tr class="row-odd"><td><p>method</p></td>
<td><p>str</p></td>
<td><p>Prorating method (“SCALING” or “BASIC”). Default = “BASIC”. <br><br> When <code class="docutils literal notranslate"><span class="pre">method=&quot;BASIC&quot;</span></code> the signs of some variables may change during the prorating process. When <code class="docutils literal notranslate"><span class="pre">method=&quot;SCALING&quot;</span></code> the signs of variables can never change. If all values are of the same sign (i.e., all positive or all negative), both methods produce identical results.</p></td>
</tr>
<tr class="row-even"><td><p>modifier</p></td>
<td><p>str</p></td>
<td><p>Global modifier (“ALWAYS”, “IMPUTED”, “ORIGINAL”) to control which values are prorated. Default = “ALWAYS” <br><br> Specify <code class="docutils literal notranslate"><span class="pre">modifier=&quot;IMPUTED&quot;</span></code> to only prorate previously imputed data, and <code class="docutils literal notranslate"><span class="pre">modifier=&quot;ORIGINAL&quot;</span></code> to only impute original data. If either is specified, then <code class="docutils literal notranslate"><span class="pre">instatus</span></code> is required. Imputed values are identified as those with an input status flag of the form I–, except for IDE. Values with any other flag (including FTI and FTE) or without a flag are treated as original data. Specify <code class="docutils literal notranslate"><span class="pre">modifier=&quot;ALWAYS&quot;</span></code> to impute all values regardless of their status.</p></td>
</tr>
<tr class="row-odd"><td><p>lower_bound</p></td>
<td><p>float</p></td>
<td><p>Lower bound on the relative change of the variables. Default = 0. <br><br> Relative change of a variable is equal to the prorated value (after rounding) divided by the original value. The <code class="docutils literal notranslate"><span class="pre">lower_bound</span></code> parameter places a limit on this ratio; prorating will not be performed if the relative change is lower. For <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">&quot;SCALING&quot;</span></code>, the lower bound must be greater than or equal to zero; this ensures that the values cannot change sign during prorating. For <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">&quot;BASIC&quot;</span></code>, users may specify a negative lower bound if <code class="docutils literal notranslate"><span class="pre">accept_negative=True</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>upper_bound</p></td>
<td><p>float</p></td>
<td><p>Upper bound on the relative change of the variables. <br><br> Relative change of a variable is equal to the prorated value (after rounding) divided by the original value. The <code class="docutils literal notranslate"><span class="pre">upper_bound</span></code> parameter places a limit on this ratio; prorating will not be performed if the relative change exceeds this threshold.</p></td>
</tr>
<tr class="row-odd"><td><p>verify_edits</p></td>
<td><p>bool</p></td>
<td><p>Verify the consistency of the edits without performing any prorating. Default=False.</p></td>
</tr>
<tr class="row-even"><td><p>accept_negative</p></td>
<td><p>bool</p></td>
<td><p>Treat negative values as valid. Default=False. <br><br> By default, a positivity edit is added for every variable in the list of edits; this parameter permits users to remove this restriction. If required, users may directly add positivity edits for individual variables.</p></td>
</tr>
<tr class="row-odd"><td><p>by</p></td>
<td><p>str</p></td>
<td><p>Variable(s) used to partition indata into by-groups for independent processing.<br><br> Prorating is performed on one observation at a time. So specifying by-groups variables will not influence the results.<br><br> Example: <code class="docutils literal notranslate"><span class="pre">by</span> <span class="pre">=</span> <span class="pre">&quot;province</span> <span class="pre">industry&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>prefill_by_vars</p></td>
<td><p>bool</p></td>
<td><p>Add by-group variable(s) to input status file to improve performance. Default=True.</p></td>
</tr>
<tr class="row-odd"><td><p>presort</p></td>
<td><p>bool</p></td>
<td><p>Sort input tables before processing, according to procedure requirements. Default=True.</p></td>
</tr>
<tr class="row-even"><td><p>no_by_stats</p></td>
<td><p>bool</p></td>
<td><p>Reduce log output by suppressing by-group specific messages. Default=False.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Link to this heading">#</a></h2>
<section id="edit-syntax-and-restrictions">
<h3>Edit syntax and restrictions<a class="headerlink" href="#edit-syntax-and-restrictions" title="Link to this heading">#</a></h3>
<p>Unlike other Banff procedures, the prorate procedure includes a unique syntax and restrictions on the <code class="docutils literal notranslate"><span class="pre">edits</span></code>. Individual edits parameter must be written in the form</p>
<p>$$ w_1 x_1 : m_1 + … + w_n x_n : m_n = y $$</p>
<p>where <em>x<sub>i</sub></em> and <em>y</em> are variables on indata, <em>w<sub>i</sub></em> are weights and <em>m<sub>i</sub></em> are modifiers. The <em>x<sub>i</sub></em> variables are referred to as components and must appear on the left-hand-side of the equation. The <em>y</em> variable is referred to as the total and must appear on the right-hand-side of the equation. Individual edits are always separated by a semi-colon.</p>
<p>The set of <code class="docutils literal notranslate"><span class="pre">edits</span></code> must have a hierarchical structure. That is, there must be one variable, the <em>grand-total</em>, that shows up as a total <em>y</em> in one equation, but not as a component <em>x<sub>i</sub></em> in any others. The components that contribute to the grand-total may act as <em>sub-totals</em> for other equations, but only once; double-decompositions are not permitted. There is no limit to the number of levels in the hierarchy specified by the user. These restrictions can be summarized with the following rules:</p>
<ul class="simple">
<li><p><em>Grand-total</em>: Exactly one variable must appear as a total but never as a component. This variable is never altered by the procedure.</p></li>
<li><p><em>Sub-totals</em>: All other variables that appear as a total in one equation must appear as a component in another equation.</p></li>
<li><p>In the complete set of <code class="docutils literal notranslate"><span class="pre">edits</span></code>, each variable can appear at most two times: once as a component <em>x<sub>i</sub></em> and once as a total <em>y</em>.</p></li>
</ul>
<p>Weights <em>w<sub>i</sub></em> are optional. They must be a positive number; if not assigned to a variable, a default weight of one is applied. Weights can be used to control the relave amount of change in each component due to prorating, change being inversely proportional to the assigned weight. Weights are only assigned to the components, not the total.</p>
<p>Modifier codes <em>m<sub>i</sub></em> are optional. Similar to weights, they can be assigned to individual variables, specified after the variable name and separated by a colon. Modifiers determine which variables are eligible for prorating. They behave in the same way as the global parameter <code class="docutils literal notranslate"><span class="pre">modifier</span></code>. The permitted codes are:</p>
<ul class="simple">
<li><p>“A” (Always): The variable can always be prorated. (Default approach.)</p></li>
<li><p>“N” (Never): The variable is never prorated.</p></li>
<li><p>“I” (Imputed): Only previously imputed values are prorated. Previously imputed values are identified by an imputation code I– on the instatus file, except for IDE which is treated as an original value.</p></li>
<li><p>“O” (Original): Only original values are prorated. This includes values with status codes of IDE, FTI, and FTE, as well as any values without a status code on instatus.</p></li>
</ul>
<p>If modifier codes “A” or “I” are used, then instatus must be specified. Note that modifiers specified in the <code class="docutils literal notranslate"><span class="pre">edits</span></code> overrule the global modifier specified by the <code class="docutils literal notranslate"><span class="pre">modifier</span></code> parameter.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prorate_call</span> <span class="o">=</span> <span class="n">banff</span><span class="o">.</span><span class="n">prorate</span><span class="p">(</span>
    <span class="n">edits</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    sub1 + sub2 + sub3:N = grandtotal;</span>
<span class="s2">    2a + b = sub1;</span>
<span class="s2">    c:I + d:I + e:I + f:I = sub2;</span>
<span class="s2">    2g:O + 3h:A = sub3;</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="o">...</span> <span class="c1"># other parameters</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>In the above example:</p>
<ul class="simple">
<li><p>Variable <code class="docutils literal notranslate"><span class="pre">sub3</span></code> is never prorated.</p></li>
<li><p>Variable <code class="docutils literal notranslate"><span class="pre">a</span></code> has a weight of 2.</p></li>
<li><p>Variables <code class="docutils literal notranslate"><span class="pre">c,d,e,f</span></code> are only prorated if the values were previously imputed.</p></li>
<li><p>Variable <code class="docutils literal notranslate"><span class="pre">g</span></code> has a weight of 2 and only original values are prorated.</p></li>
<li><p>Variable <code class="docutils literal notranslate"><span class="pre">h</span></code> has a weight of 3 and is always prorated, whether or the the value is original or imputed.</p></li>
</ul>
</section>
<section id="top-down-prorating-procedure">
<h3>Top-down prorating procedure<a class="headerlink" href="#top-down-prorating-procedure" title="Link to this heading">#</a></h3>
<p>The prorate procedure begins with the grand-total. If the components of the grand-total equation do not sum to the grand-total, the prorating procedure is performed, adjusting the component values as necessary. (The grand-total never changes). This process then repeats for any of the components that are sub-totals, i.e., component variables that appear as totals in other edit equations. Note that in this process, each value is only prorated once, when it appears as a component.</p>
</section>
<section id="rounding">
<h3>Rounding<a class="headerlink" href="#rounding" title="Link to this heading">#</a></h3>
<p>The prorate procedure includes a rounding algorithm to adjust all fields to the correct number of decimal places while satisfying the <code class="docutils literal notranslate"><span class="pre">edits</span></code>. Users can specify the desired number of decimal places using the <code class="docutils literal notranslate"><span class="pre">decimal</span></code> parameter; the default value is zero (i.e., whole numbers). The value of <code class="docutils literal notranslate"><span class="pre">decimals</span></code> must be an integer within [0,9], and must be equal to or greater than the actual number of decimals found on the total.</p>
<p>Note that the order of component variables in the edit equations can affect the results of the rounding algorithm, when the amount of required prorating cannot be evenly distributed amongst the components.</p>
<p>When there are very large summation components (i.e. larger than 9 digits with or without decimals), the procedure is not able to accurately prorate them to the total with a precision of 9 decimals. In such a case, the observation will be rejected and listed with a decimal error in the outreject table. To avoid this, one can reduce the value of the <code class="docutils literal notranslate"><span class="pre">decimal</span></code>, for example by setting <code class="docutils literal notranslate"><span class="pre">decimal=8</span></code> or lower.</p>
</section>
<section id="rejected-records">
<h3>Rejected records<a class="headerlink" href="#rejected-records" title="Link to this heading">#</a></h3>
<p>Sometimes prorating cannot be successfully performed on an individual, in which case the prorate procedure will output the record to the outreject table, alongside the reason for the failed prorating attempt. Reasons include:</p>
<ul class="simple">
<li><p>The prorated values are outside the user-specified bounds.</p></li>
<li><p>The scaling value <em>k</em> is outside the interval [-1,1]. (Only for <code class="docutils literal notranslate"><span class="pre">method=&quot;scaling&quot;</span></code>)</p></li>
<li><p>The factor <em>k</em> cannot be calculated because the weighted sum of proratable columns is zero.</p></li>
<li><p>The record includes negative values and <code class="docutils literal notranslate"><span class="pre">accept_negative=True</span></code> isn’t specified.</p></li>
<li><p>No values are eligible for prorating due to the “ORIGINAL” or “IMPUTED” modifier.</p></li>
<li><p>The user has specified fewer decimal places than exist in the adjusted total.</p></li>
</ul>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#input-and-output-tables">Input and output tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters">Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notes">Notes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#edit-syntax-and-restrictions">Edit syntax and restrictions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#top-down-prorating-procedure">Top-down prorating procedure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rounding">Rounding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rejected-records">Rejected records</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/EN/Procedure Guides/prorate.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Statistics Canada / Statistique Canada.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>